version: '3.8'

# Use this file when you have a local PostgreSQL installation
# Run with: docker-compose -f docker-compose.api-only.yml up --build

services:
  webtemplate-api:
    build:
      context: .
      dockerfile: src/WebTemplate.WebApi/Dockerfile
    container_name: webtemplate-api
    ports:
      - "5000:8080"
      - "5001:8081"
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      # Update this connection string to point to your local PostgreSQL
      - CONNECTION_STRING=Host=host.docker.internal;Port=5432;Database=WebTemplateDb;Username=postgres;Password=postgres123
      - JWT_SECRET_KEY=webtemplatewebtemplatewebtemplate
      - JWT_ISSUER=WebTemplate.Api
      - JWT_AUDIENCE=WebTemplate.Client
      - JWT_EXPIRY_MINUTES=60
      - JWT_REFRESH_TOKEN_EXPIRY_DAYS=7
      - ADMIN_EMAIL=admin@webtemplate.com
      - ADMIN_USERNAME=admin
      - ADMIN_PASSWORD=Admin@123
      - ADMIN_FIRSTNAME=System
      - ADMIN_LASTNAME=Administrator
      - CORS_ALLOWED_ORIGINS=http://localhost:5173,https://localhost:5173,http://localhost:3000
    extra_hosts:
      - "host.docker.internal:host-gateway"
